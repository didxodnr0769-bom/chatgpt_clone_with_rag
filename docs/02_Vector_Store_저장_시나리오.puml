@startuml VectorStoreInitialization

title 벡터 스토어 초기화 과정

participant "서버 시작" as Server
participant "DocumentService" as DocService
participant "EmbeddingService" as EmbedService
participant "VectorStore" as VectorStore
participant "Ollama API" as Ollama
database "docs/*.md" as Docs
database "vector_store.json" as VectorDB

== 서버 시작 시 자동 초기화 ==
Server -> DocService: 마크다운 문서 읽기
DocService -> Docs: docs 폴더의 .md 파일들 로드
DocService -> DocService: 문서를 청크로 분할

== 임베딩 생성 ==
loop 각 문서 청크
    DocService -> EmbedService: 텍스트 임베딩 생성 요청
    EmbedService -> Ollama: nomic-embed-text 모델로 임베딩 생성
    Ollama -> EmbedService: 벡터 데이터 반환
    EmbedService -> VectorStore: 문서와 임베딩 저장
end

== 벡터 스토어 저장 ==
VectorStore -> VectorDB: vector_store.json에 영구 저장
note right of VectorDB: 다음 서버 시작 시\n재사용 가능

== 초기화 완료 ==
Server -> Server: RAG 서비스 준비 완료
note over Server: 이제 사용자 질문에\n문서 기반 답변 가능

@enduml